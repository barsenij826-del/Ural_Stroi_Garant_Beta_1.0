const portfolioGrid = document.getElementById('portfolioGrid');
    const loadMoreBtn = document.getElementById('loadMoreBtn');
    let visibleCount = 4;

    function initPortfolio() {
        let html = '';
        portfolioData.forEach((project, index) => {
            const id = index + 1;
            const isHidden = id > visibleCount ? 'hidden' : '';
            
            // ВАЖНО: здесь добавлен id="project-${id}"
            html += `
                <div class="project-frame ${isHidden}" id="project-${id}" onclick="openGallery(${index})">
                    <div class="project-card">
                        <div class="hover-btn">Посмотреть проект</div>
                        <img src="img/work_${id}.webp" alt="${project.title}" loading="lazy" onerror="hideBrokenProject(${id})">
                        <div class="project-info-overlay">
                            <h3>${project.title}</h3>
                            <p>${project.desc}</p>
                        </div>
                    </div>
                </div>`;
        });
        portfolioGrid.innerHTML = html;
    }

    function hideBrokenProject(id) {
        const card = document.getElementById('project-' + id);
        if (card) {
            card.remove();
            console.log('Проект ' + id + ' удален, так как фото не найдено');
        }
        checkLoadMoreButton();
    }

    function loadMore() {
        const hiddenCards = Array.from(document.querySelectorAll('.project-frame.hidden'));
        const nextBatch = hiddenCards.slice(0, 4);
        nextBatch.forEach(card => card.classList.remove('hidden'));
        checkLoadMoreButton();
    }

    function checkLoadMoreButton() {
        const remainingHidden = document.querySelectorAll('.project-frame.hidden');
        if (remainingHidden.length === 0) {
            loadMoreBtn.style.display = 'none';
        }
    }

    // Запускаем один раз
    initPortfolio();
